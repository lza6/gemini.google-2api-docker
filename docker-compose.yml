services:
  nginx:
    image: nginx:latest
    container_name: gemini-2api-nginx
    restart: always
    ports:
      - "${NGINX_PORT:-8088}:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - app
    networks:
      - gemini-net

  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: gemini-2api-app
    restart: unless-stopped
    env_file:
      - .env
    # 关键：只保留 debug 目录挂载，用于导出截图和日志
    volumes:
      # - ./user_data_1:/app/user_data_1 # 已移除 (纯匿名模式)
      - ./debug:/app/debug  # 确保 debug 目录被挂载出来
    networks:
      - gemini-net

networks:
  gemini-net:
    driver: bridge